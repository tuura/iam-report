\section{The state of the IAM machine}

The state of the whole IAM machine is essentially a Cartesian product of states
of every component: register bank, instruction counter, the current instruction,
flags register, memory, program and the clock. We model it as a Haskell record
data type.

\begin{figure}[H]
\begin{minted}{haskell}
data MachineState = MachineState
    { registers           :: RegisterBank
    , instructionCounter  :: InstructionAddress
    , instructionRegister :: Instruction
    , flags               :: Flags
    , memory              :: Memory
    , program             :: Program
    , clock               :: Clock
    }
\end{minted}
\label{state}
\caption{The IAM state data type.}
\end{figure}

This section gives an account on every component of the IAM machine state. Most
of the data types are symbolic words of the appropriate length and symbolic functional
arrays, i.e. mapping from symbolic keys to symbolic values. Please consult the
~\cite{SBV} documentation for additional information on the internal types.

\subsection{Registers}

The register bank is represented as a mapping from numerical encoded registers
to their values.

\begin{figure}[H]
\begin{minted}{haskell}
type RegisterBank = SFunArray Word8 Word64

type Register = SWord8
\end{minted}
\label{registers}
\caption{The IAM registers.}
\end{figure}

\subsection{Memory}

\begin{figure}[H]
\begin{minted}{haskell}
type MemoryAddress = SWord8

type Memory = SFunArray Word8 Word64
\end{minted}
\label{memory}
\caption{The IAM memory.}
\end{figure}

\subsection{Flags}

\begin{figure}[H]
\begin{minted}{haskell}
type Flags = SFunArray Word8 Bool

data Flag = Zero
          | Halted
\end{minted}
\label{flags}
\caption{The IAM flags.}
\end{figure}

\subsection{Program}

\begin{figure}[H]
\begin{minted}{haskell}
type InstructionAddress = SWord16

type Program = [(InstructionAddress, Instruction)]
\end{minted}
\label{program}
\caption{The IAM program.}
\end{figure}

\subsection{Clock}

\begin{figure}[H]
\begin{minted}{haskell}
type Clock = SWord64
\end{minted}
\label{clock}
\caption{The IAM clock.}
\end{figure}